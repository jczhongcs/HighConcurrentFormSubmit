<!DOCTYPE html>

<html lang="en">
<head>
  <title>反馈信息</title>
  <link rel="stylesheet"  href="/bootstrap/css/styles.css">
  <link rel="stylesheet" href="/bootstrap/css/colors.css">
  <link rel="stylesheet" href="/bootstrap/css/cont.css">
  <!-- jquery -->
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <!-- bootstrap -->
  <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css" />
  <script type="text/javascript" src="/bootstrap/js/bootstrap.min.js"></script>
  <!-- jquery-validator -->
  <script type="text/javascript" src="/jquery-validation/jquery.validate.min.js"></script>
  <script type="text/javascript" src="/jquery-validation/localization/messages_zh.min.js"></script>
  <!-- layer -->
  <script type="text/javascript" src="/layer/layer.js"></script>
  <!-- md5.js -->
  <script type="text/javascript" src="/js/md5.min.js"></script>
  <!-- common.js -->
  <script type="text/javascript" src="/js/common.js"></script>
  <script src="/js/popper.min.js"></script>
  <script src="/js/custom.js"></script>
  <script src="/js/moment.min.js"></script>
  <script src="/js/daterangepicker.js"></script>
  <script src="/js/dropzone.js"></script>
  <script src="/js/imagesloaded.js"></script>
  <script src="/js/ion.rangeSlider.min.js"></script>
  <script src="/js/jquery.magnific-popup.min.js"></script>
  <script src="/js/lightbox.js"></script>
  <script src="/js/markerclusterer.js"></script>
  <script src="/js/morris.min.js"></script>
  <script src="/js/raphael.min.js"></script>
  <script src="/js/select2.min.js"></script>
  <script src="/js/slick.js"></script>
  <script src="/js/slider-bg.js"></script>
  <script src="/js/script.js"></script>



</head>
<body onload="checking();">
<div th:insert="stuhead.html"></div>
<div class="container-fluid p-0">
  <div class="row">

    <div class="col-lg-3 col-md-4 col-sm-12">
      <div class="property_dashboard_navbar">
        <div class="dash_user_menues">
          <ul>
            <li></li>
            <li></li>
            <li>
              <a href="/stumanage/to_sel" style="color:white">
                <i class="ti-hummer"></i>&nbsp;选择课程
              </a>
            </li>
            <li></li>
            <li >
              <a href="/stumanage/seled_course" style="color:white">
                <i class="ti-gift"></i>&nbsp;已选课程
              </a>
            </li>
            <li></li>
            <li>
              <a href="/stumanage/userinfo" style="color:white">
                <i class="ti-user"></i>&nbsp;个人信息
              </a>
            </li>
            <li></li>
            <li class="active">
              <a href="/stumanage/feedback" style="color:white">
                <i class="ti-email"></i>&nbsp;反馈意见
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>


    <div class="col-lg-9 col-md-8 col-sm-12">
      <section style="padding-top:10px";>
        <div class="container">
          <div class="row">
                  <form id="feedbackForm">

                    <div class="col-lg-12 col-md-12">
                      <div class="submit-page form-simple">
                        <div class="frm_submit_block">
                          <h2>反馈信息</h2>
                          <div class="form-row">

                            <div class="form-group col-md-8">

                              <input type="hidden" id="userId" name="userId" class="form-control" th:value=${user!=null}?${user.id}>

                            </div>

                            <div class="form-group col-md-8">
                              <label>姓名</label>
                              <input type="text" id="userNickname" name="userNickname" class="form-control" placeholder="姓名" th:value=${user!=null}?${user.nickname} required="required">
                            </div>

                            <div class="form-group col-md-6">
                              <label>年级</label>
                              <select th:field="${feedback.userGrade}" class="form-control" name="userGrade" id="userGrade" required="required">
                                <option th:selected="${user.grade=='大一'}" value="大一">大一</option>
                                <option th:selected="${user.grade=='大二'}" value="大二">大二</option>
                                <option th:selected="${user.grade=='大三'}" value="大三">大三</option>
                                <option th:selected="${user.grade=='大四'}" value="大四">大四</option>
                              </select>
                            </div>

                            <div class="form-group col-md-8">
                              <label>手机号</label>
                              <input type="text" id="userPhone" name="userPhone" class="form-control" placeholder="手机号" th:value=${user!=null}?${user.phone}  required="required">
                            </div>

                            <div class="form-group col-md-8">
                              <label>邮箱</label>
                              <input type="text" id="userEmail" name="userEmail" class="form-control" placeholder="邮箱" th:value=${user!=null}?${user.email} required="required">

                            </div>
                            <div class="form-group col-md-12"><br></div>

                            <div class="form-group col-md-8">
                              <label> &nbsp;课程满意度</label> &nbsp; &nbsp;
                              <input type="radio" name="courseSat" id="c1" value="1"><label for="c1">1</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="courseSat" id="c2" value="2"><label for="c2">2</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="courseSat" id="c3" value="3"><label for="c3">3</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="courseSat" id="c4" value="4"><label for="c4">4</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="courseSat" id="c5" value="5"><label for="c5">5</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                            </div>
                            <br>
                            <br>
                            <br>
                            <div class="form-group col-md-8">
                              <label> &nbsp;选课满意度</label> &nbsp; &nbsp;
                              <input type="radio" name="selSat" id="s1" value="1"><label for="s1">1</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="selSat" id="s2" value="2"><label for="s2">2</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="selSat" id="s3" value="3"><label for="s3">3</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="selSat" id="s4" value="4"><label for="s4">4</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="selSat" id="s5" value="5"><label for="s5">5</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                            </div>
                            <br>
                            <br>
                            <br>
                            <div class="form-group col-md-8">
                              <label> &nbsp;总体满意度</label> &nbsp; &nbsp;
                              <input type="radio" name="totalSat" id="t1" value="1"><label for="t1">1</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="totalSat" id="t2" value="2"><label for="t2">2</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="totalSat" id="t3" value="3"><label for="t3">3</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="totalSat" id="t4" value="4"><label for="t4">4</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                              <input type="radio" name="totalSat" id="t5" value="5"><label for="t5">5</label>
                              &nbsp; &nbsp;&nbsp; &nbsp;
                            </div>

                            <br>
                            <br>

                            <br>
                            <br>

                            <div class="form-group col-md-8">
                              <label>反馈类型</label>
                              <select th:field="${feedback.feedBackType}" class="form-control" name="feedBackType" id="feedBackType" required="required">
                                <option th:selected="${feedback.feedBackType=='课程内容反馈'}" value="课程内容反馈">课程内容反馈</option>
                                <option th:selected="${feedback.feedBackType=='选课反馈'}" value="选课反馈">选课反馈</option>
                                <option th:selected="${feedback.feedBackType=='个人信息提交反馈'}" value="个人信息提交反馈">个人信息提交反馈</option>
                                <option th:selected="${feedback.feedBackType=='其它'}" value="其它">其它</option>
                              </select>
                            </div>

                            <div class="form-group col-md-8">
                              <label>反馈描述</label>
                              <input type="text" id="feedBackDescribe" name="feedBackDescribe" class="form-control" placeholder="反馈问题简要描述"  required="required">
                            </div>

                            <div class="form-group col-md-8">
                              <label>意见</label>
                              <textarea class="form-control ht-120" id="feedBackContent" name="feedBackContent" cols="30" rows="7" placeholder="请填写意见"  required="required"></textarea>
                            </div>


                            <div class="form-group col-md-12">
                              <div class="col-lg-12 col-md-12">
                                <br>
                                <br>
                             <!--   <button class="btn bg-2" style="margin-left: 25px" type="button" onclick="submitFeedback()">提交</button>-->
                              </div>
                            </div>

                          </div>
                        </div>
                      </div>
                    </div>

                  </form>
        </div>
      </div>
      </section>
    </div>
  </div>
</div>

<div th:insert="adend.html"></div>


</body>

<script>
  function checking(){
    setInterval(checkModification,4000);
  }

  function checkModification() {
    var inputs = document.getElementsByTagName("input");
    var textareas = document.getElementsByTagName("textarea");
    var selects = document.getElementsByTagName("select");
    var notEmpty = true;
    for (var i=0;i<inputs.length;i++) {
      if (inputs[i].type=="radio"&&(inputs[i].checked==null)) {
        notEmpty = false;
      }
      if (inputs[i].type!="radio"&&inputs[i]==null) {
          notEmpty = false;
      }
    }
    for (var i=0;i<textareas.length;i++) {
      if (textareas[i]==null||textareas[i].textLength<10) {
        notEmpty = false;
      }
    }
    for (var i=0;i<selects.length;i++) {
      if (selects[i]==null) {
        notEmpty = false;
      }
    }
    if(notEmpty){
      submitFeedback();
    }

  }

  $.fn.xiubin_serialize = function () {
    var a = this.serializeArray();
    var $radio = $('input[type=radio],input[type=checkbox]', this);
    var temp = {};
    $.each($radio, function () {
      if (!temp.hasOwnProperty(this.name)) {
        if ($("input[name='" + this.name + "']:checked").length == 0) {
          temp[this.name] = "";
          a.push({name: this.name, value:0});
        }
      }
    });
    console.log(a);
    return jQuery.param(a);
  };


  function submitFeedback(){
    $.ajax({
      url:"/stumanage/feedbacksubmit2",
      type:"POST",
      async:false,
      data:$("#feedbackForm").xiubin_serialize(),

      success:function(data){
        var result = data.data;
        if(data.code != 0){
          //window.location.href="/order_info.htm?orderId="+data.data.id;
          if(result > 0 ){
            layer.msg("提交成功");
            window.location.reload();
          }
          else{
            layer.msg("提交成功");
            window.location.reload();
          }

        }else{
          layer.msg(data.msg);
          window.location.reload();
        }
      },
      error:function(){
        layer.msg("客户端请求有误");
      }

    });
  }
</script>
</html>